## MongoDB

1. MongoDb放弃关系模型的主要原因就是为了获得更方便的扩展性。MongoDb在设计之初就考虑到了扩展的问题。它所采用的面向文档的数据模型使其可以自动在多台服务器之间分割数据。还可以平衡集群的数据和负载，自动重排文档。需要更大的容量时，只需要在集群中添加新机器，剩下的事交给数据库来处理。

2. 有的和没的功能  
	有的：
	- 索引
	- 存储javascript，不必再使用存储过程了。
	- 聚合，支持MapReduce和其他聚合工具。
	- 固定集合，集合的大小是有上限的。
	- 文件存储  

	没的：没有了关系型数据库的join和多行事务，主要是为了扩展性做的舍弃。

3. 为了性能，mongodb使用MongoDB传输协议所谓与服务器交互的主要方式，这比HTTP/REST协议开销更少。

4. MongoDb的管理理念是让服务器自管理。如果主服务器挂了，自动切换到备份服务器上，并将备份服务器提升为活跃服务器。分布式环境下，集群只要知道增加了新的节点，会自动集成和配置新节点。

### 文档
1. 文档中不能有重复的键。
2. 文档中的键值对是有序的。内容一样，但顺序不一样的文档是完全不同的。
3. 键是区分大小写的。
4. 键不能含有\0，这个字符用来表示键的结尾。
5. .和$有特殊意义
6. _开头的键是保留的，不严格要求。

### 集合
集合是文档的集合。类似于关系数据库无模式的表。
索引是按照集合来定义的。把同种类型的文档放入同一个集合可以使索引更加有效。

- 集合名不能是空字符串""，不能含有\0，不能以system.开头，用户创建的集合不要含有$
- 子集合，如aa.bb,aa.cc，更合理的组织数据

### 数据库
多个集合组成数据库。一个MongoDb实例可以承载多个数据库，他们之间可视为完全独立的。每个数据库都有独立的权限控制。

- 数据库名应全部小写，最多64字节。不能是空，不能含有.$/\和\0
- 数据库最终会变成文件系统里的文件
- 保留的数据库名：
	- admin  从权限角度看，这是root数据库，要是将一个用户添加到这个数据库，那么这个用户将自动继承所有数据库的权限，一些特定的服务器端命令如列出所有数据库或者关闭服务器等，也只能从这个数据库运行。
	- local  这个数据库永远不会被复制，这个数据库可用于存储只与本地单台服务器相关的集合。
	- config 当Mongo用于分片设置时，config数据库在内部使用，用于保存分片的相关信息

数据库名+集合名就是完整的集合限定名，称为命名空间。

### 安装MongoDB
1. 服务器suse11
2. 下载mongodb downloads.mongodb.org/linux/mongodb-linux-x86_64-2.6.4.tgz （3.*版本需要GLIBCXX_3.4.14）
3. 将mongodb-linux-x86_64-2.6.4.tgz下载到mongodb文件夹
4. 解压：tar -zxvf mongodb-linux-x86_64-2.6.4.tgz
5. 重命名：mv mongodb-linux-x86_64-2.6.4 mongodb
6. 设置环境变量：export PATH=<mongodb-install-directory>/bin:$PATH
    例如：export "PATH=$PATH:/home/nim/mongodb/bin/"  >>/etc/profile
7. 启动，Mongodb数据库需要指定存储数据的文件夹，默认存储目录为：/data/db。
创建目录/data/db:mkdir -p /data/db  
进入mongodb/bin 运行` mongod`即可启动mongodb。  
可加参数：  
-port portNo 指定端口，默认27017  
--dbpath dataPath 指定存放数据的目录  
--logpath logPath  指定日志目录  
--fork  后台运行，--fork必须和--logpath一起

8. 登陆  
执行mongo
